# SECURITY - MYSQL ENTERPRISE AUDIT

## Introduction

*Describe the lab in one or two sentences, for example:* This lab walks you through the steps to ...

Estimated Lab Time: -- minutes

### About <Product/Technology> (Optional)
Enter background information here about the technology/feature or product used in this lab - no need to repeat what you covered in the introduction. Keep this section fairly concise. If you find yourself needing more than to sections/paragraphs, please utilize the "Learn More" section.

### Objectives

*List objectives for this lab using the format below*

In this lab, you will:
* Objective 1
* Objective 2
* Objective 3

### Prerequisites (Optional)

*List the prerequisites for this lab using the format below. Fill in whatever knowledge, accounts, etc. is necessary to complete the lab. Do NOT list each previous lab as a prerequisite.*

This lab assumes you have:
* An Oracle account
* All previous labs successfully completed


*This is the "fold" - below items are collapsed by default*

## Task 1: Concise Step Description
3d) MySQL Enterprise Audit
Objective: Auditing in action…
Notes:
•	Audit can be activated and configured without stop the instance. In the lab we edit my.cnf to see how to do it in this way
Server: serverB
1.	Enable Audit Log on mysql-advanced (remember: you can’t install on mysql-gpl).  Audit is COMMERCIAL plugin.
a.	Edit the my.cnf setting in /mysql/etc/my.cnf
shell> sudo nano /mysql/etc/my.cnf

b.	Change the line “plugin-load=thread_pool.so” to load the plugin
plugin-load=thread_pool.so;audit_log.so

c.	below the previous add these lines to make sure that the audit plugin can't be unloaded and that the file is automatically rotated at 20 MB
audit_log=FORCE_PLUS_PERMANENT
audit_log_rotate_on_size=20971520

d.	Restart MySQL (you can configure audit without restart the server, but here we show how to set the configuration file)
shell> sudo systemctl restart mysqld-advanced
2.	Login to a mysql-advanced with the user “appuser”, then submit some commands

shell> mysql -u appuser2 -p -h 127.0.0.1 -P 3307
mysql> USE world;
mysql> SELECT * FROM city limit 25;

mysql> SELECT Code, Name, Region FROM country WHERE population > 200000;

3.	Open the audit.log file the datadir and verify the content

shell> nano /mysql/data/audit.log

4.	In addition, if you'd like to reduce the amount of data generated by the Audit Plugin you can use filters. As an example, to just trace 'Login' add this line to my.cnf file

audit_log_policy=Login

5.	Now restart the server and test again

shell> sudo systemctl restart mysqld-advanced

6.	You can check the documentation about other Log policies

## Learn More

*(optional - include links to docs, white papers, blogs, etc)*

* [URL text 1](http://docs.oracle.com)
* [URL text 2](http://docs.oracle.com)

## Acknowledgements
* **Author** - Perside Foster, MySQL Engineering
* **Contributors** -  Marco Carlessi, MySQL Engineering
* **Last Updated By/Date** - <Perside Foster, October 2021
