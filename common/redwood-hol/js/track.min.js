/*
Author: Ashwin Agarwal
Version: 21.1
Last updated: 5-May-2021 by Ashwin Agarwal
*/

"use strict";let analytics=function(){if(-1==$.inArray(window.location.origin,["https://oracle.github.io","https://ashwin-agarwal.github.io"]))return;let i=function(){var i,o,n,e=navigator.appVersion,s=navigator.userAgent,r=navigator.appName,t=""+parseFloat(navigator.appVersion),l=parseInt(navigator.appVersion,10);-1!=(o=s.indexOf("Opera"))&&(r="Opera",t=s.substring(o+6),-1!=(o=s.indexOf("Version"))&&(t=s.substring(o+8))),-1!=(o=s.indexOf("OPR"))?(r="Opera",t=s.substring(o+4)):-1!=(o=s.indexOf("Edge"))?(r="Microsoft Legacy Edge",t=s.substring(o+5)):-1!=(o=s.indexOf("Edg"))?(r="Microsoft Edge",t=s.substring(o+4)):-1!=(o=s.indexOf("MSIE"))?(r="Microsoft Internet Explorer",t=s.substring(o+5)):-1!=(o=s.indexOf("Chrome"))?(r="Chrome",t=s.substring(o+7)):-1!=(o=s.indexOf("Safari"))?(r="Safari",t=s.substring(o+7),-1!=(o=s.indexOf("Version"))&&(t=s.substring(o+8))):-1!=(o=s.indexOf("Firefox"))?(r="Firefox",t=s.substring(o+8)):-1!=s.indexOf("Trident/")?(r="Microsoft Internet Explorer",t=s.substring(s.indexOf("rv:")+3)):(i=s.lastIndexOf(" ")+1)<(o=s.lastIndexOf("/"))&&(r=s.substring(i,o),t=s.substring(o+1),r.toLowerCase()==r.toUpperCase()&&(r=navigator.appName)),-1!=(n=t.indexOf(";"))&&(t=t.substring(0,n)),-1!=(n=t.indexOf(" "))&&(t=t.substring(0,n)),-1!=(n=t.indexOf(")"))&&(t=t.substring(0,n)),l=parseInt(""+t,10),isNaN(l)&&(t=""+parseFloat(navigator.appVersion),l=parseInt(navigator.appVersion,10));var a=/Mobile|mini|Fennec|Android|iP(ad|od|hone)/.test(e),d=!!navigator.cookieEnabled;void 0!==navigator.cookieEnabled||d||(document.cookie="testcookie",d=-1!=document.cookie.indexOf("testcookie"));var c="-",u=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 3.11",r:/Win16/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Chrome OS",r:/CrOS/},{s:"Linux",r:/(Linux|X11(?!.*CrOS))/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(Mac OS|MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}];for(var w in u){var _=u[w];if(_.r.test(s)){c=_.s;break}}var g="-";switch(/Windows/.test(c)&&(g=/Windows (.*)/.exec(c)[1],c="Windows"),c){case"Mac OS":case"Mac OS X":case"Android":g=/(?:Android|Mac OS|Mac OS X|MacPPC|MacIntel|Mac_PowerPC|Macintosh) ([\.\_\d]+)/.exec(s)[1];break;case"iOS":g=(g=/OS (\d+)_(\d+)_?(\d+)?/.exec(e))[1]+"."+g[2]+"."+(0|g[3])}return{os:c,osv:g,br:r,brv:l+" ("+t+")",mob:a,coo:d,scr:0,ua:navigator.userAgent}}(),o=function(i){return 1==i?Math.random().toString(36).substr(2,8):2==i?Date.now().toString(36)+Math.random().toString(36).substr(2,8):3==i?Date.now().toString(36)+Math.random().toString(36).substr(2,8)+Math.random().toString(36).substr(2,8):void console.log("Byte value not defined!")},n=function(i,o){return sessionStorage.setItem(i,o),s(i)},e=function(i){return window.localStorage.getItem(i)},s=function(i){return sessionStorage.getItem(i)},r=function(i="lab"){let o=window.location.search.substring(1).split("&");for(var n=0;n<o.length;n++)if(o[n].split("=")[0]==i)return o[n].split("=")[1];return"lab"==i?$(".selected").closest("li").attr("id").substring(4):null},t=function(i,o){navigator.sendBeacon(i,new Blob([JSON.stringify(o)],{type:"application/json"}))},l=function(){return setInterval(function(){n("ll_duration",parseInt(s("ll_duration"))+1)},1e3)},a=function(i){console.log("sending duration");let o={dur:s("ll_duration"),eve:i,vid:s("ll_view_id"),wid:s("ll_workshop_id"),uid:e("ll_user_id")};t("https://apex.oracle.com/pls/apex/ashwin-agarwal/livelabs/record_lab_change",o)},d=window.location.href.split("?")[0];var c,u;d.includes(".html")||(d+="index.html"),null==e("ll_user_id")&&(c="ll_user_id",u=o(3),window.localStorage.setItem(c,u),e(c),function(){console.log("sending user data");let o={uid:e("ll_user_id"),os:i.os,osv:i.osv,br:i.br,brv:i.brv,mob:i.mob,coo:i.coo,scr:i.scr,ua:i.ua};t("https://apex.oracle.com/pls/apex/ashwin-agarwal/livelabs/record_user",o)}()),null!=s("ll_workshop_id")&&d===s("ll_workshop_url")||(n("ll_workshop_id",o(2)),n("ll_workshop_url",d),function(){console.log("sending workshop view");let i=$(".hol-Header-logo").clone().children().remove().end().text();i=""==i?"<no title>":i;let o={wid:s("ll_workshop_id"),url:s("ll_workshop_url"),wor:i,ll:window.self!==window.top,ses:r("session"),rf:document.referrer,tz:Intl.DateTimeFormat().resolvedOptions().timeZone,uid:e("ll_user_id")};t("https://apex.oracle.com/pls/apex/ashwin-agarwal/livelabs/record_wkshop_view",o)}()),s("ll_lab_name")!==r()&&(s("ll_lab_url")==d&&a("labchange"),n("ll_lab_name",r()),n("ll_view_id",o(2)),n("ll_duration",1),n("ll_lab_url",d),function(){console.log("sending lab view");let i={vid:s("ll_view_id"),lab:s("ll_lab_name"),tit:$(".selected > div > div:eq(1)").text(),wid:s("ll_workshop_id"),uid:e("ll_user_id")};t("https://apex.oracle.com/pls/apex/ashwin-agarwal/livelabs/record_lab_view",i)}());let w=null;"visible"===document.visibilityState&&(w=l()),document.addEventListener("visibilitychange",function(){"hidden"===document.visibilityState?clearInterval(w):"visible"===document.visibilityState&&(w=l())}),window.onunload=function(){a("unload")},console.log("ll_user_id: "+e("ll_user_id")),console.log("ll_workshop_id: "+s("ll_workshop_id")),console.log("ll_view_id: "+s("ll_view_id")),console.log("ll_lab_name: "+s("ll_lab_name")),console.log("ll_duration: "+s("ll_duration"))};setTimeout(analytics,1e3);